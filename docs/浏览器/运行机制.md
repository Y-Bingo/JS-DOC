

# 运行机制

浏览器是多进程的，一个页面就是一个渲染进程，每个进程里面又包含了，GUI渲染线程，js引擎线程，事件触发线程，定时触发线程，异步Http请求线程。

![渲染进程](\img\渲染进程.png)

### 如何理解JS单线程

单线程指的是一段时间内，只能执行一个任务。如果上一个任务需要执行很长时间，则后面的任务就会被一直阻塞。
js引擎线程就是js内核，负责解析与执行js代码，也称为主线程。浏览器同时只能有一个js引擎线程在运行js程序，所以js是单线程。

### 任务队列

* JS分为同步任务和异步任务
* 同步任务都在主线程上执行，形成了一个*执行栈*
* 事件触发线程管理着一个*任务队列*，用来存放异步运行结果

### 什么是Event Loop

![事件循环](\img\事件循环.png)

1. 主线程执行操作，形成执行栈。
2. 执行过程中遇到回到异步操作，把异步操作挂起，执行执行下面的同步操作
3. 事件触发线程管理者着一个任务队列，当异步任务有运行结果的时候，就把它们的回调函数到*任务队列*中
4. 一旦*执行栈*中的所有同步任务执行完毕（JS引擎空闲），系统就会读取*任务队列*，将可运行的异步任务添加到可执行栈中，开始执行
5. 整个过程，已经执行栈、任务队列构成**Event Loop**；

#### 参考

* [从浏览器多进程到JS单线程，JS运行机制最全面的一次梳理](https://juejin.im/post/5a6547d0f265da3e283a1df7)
* [Js基础知识（四） - js运行原理与机制](https://segmentfault.com/a/1190000013119813)

